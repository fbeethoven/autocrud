/* This code is autogenerated by Autocrud {{ .Version }} */

package controller

import (
    "net/http"

    "github.com/gin-gonic/gin"

    "{{ .ProjectName }}/src/dao"
)

type {{ .Resource }}Controller struct {
    {{ .Resource }}DAO dao.{{ .Resource}}DAO
}

func New{{ .Resource }}Controller() *{{ .Resource }}Controller {
    return &{{ .Resource }}Controller{
        {{ .Resource }}DAO: dao.{{ .Resource }}DAO{},
    }
}

func (c {{ .Resource }}Controller) GetResource(ctx *gin.Context) {
    resources, err := c.{{ .Resource }}DAO.GetResource()
    if err != nil {
        ctx.JSON(http.StatusInternalServerError, err)
    }

    ctx.JSON(http.StatusOK, resources)
}

func (c {{ .Resource }}Controller) GetResourceById(ctx *gin.Context) {
    resourceId := ctx.Param("id")

    resource, err := c.{{ .Resource }}DAO.GetResourceById(resourceId)
    if err != nil {
        ctx.JSON(http.StatusNotFound, err)
    }

    ctx.JSON(http.StatusOK, resource)
}

func (c {{ .Resource }}Controller) RegisterResource(controller *Controller) {
    controller.Resources = append(controller.Resources, c)

    controller.Router.GET("/{{ .ResourceUrl }}", c.GetResource)
    controller.Router.GET("/{{ .ResourceUrl }}/:id", c.GetResourceById)
}
